<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ReliableStore â€” My Account</title>
  <style>
    :root{
      --maxw:980px;
      --accent:#FE9900;
      --muted:#666;
      --card-bg:#fff;
      --radius:12px;
      --gap:16px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    body{background:#f6f7fb;color:#111;margin:0;padding:24px;display:flex;justify-content:center;}
    .wrap{width:100%;max-width:var(--maxw);}    
    .header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
    h1{margin:0;font-size:28px}
    .grid{display:grid;grid-template-columns:250px 1fr;gap:20px}
    .sidebar{background:var(--card-bg);padding:16px;border-radius:12px;box-shadow:0 6px 18px rgba(10,10,15,0.06)}
    .sidebar a{display:block;padding:10px 12px;color:#222;text-decoration:none;border-radius:8px;margin-bottom:8px}
    .sidebar a.active{background:linear-gradient(90deg,var(--accent),#ffb36b);color:white}
    .card{background:var(--card-bg);padding:18px;border-radius:12px;box-shadow:0 6px 18px rgba(10,10,15,0.06)}
    label{display:block;font-size:0.85rem;margin-bottom:6px;color:var(--muted)}
    input[type="text"], input[type="email"], input[type="tel"], textarea{
      width:100%;padding:10px;border-radius:8px;border:1px solid #e6e9ef;background:white;box-sizing:border-box;
    }
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .actions{display:flex;gap:8px;margin-top:12px;align-items:center}
    button{background:var(--accent);color:white;border:none;padding:10px 14px;border-radius:10px;cursor:pointer}
    button.ghost{background:#fff;border:1px solid #ddd;color:#333}
    .small{font-size:0.9rem;color:var(--muted)}
    .addresses{margin-top:12px}
    .address-card{padding:12px;border-radius:10px;border:1px dashed #eee;margin-bottom:10px;background:#fcfcff}
    .address-card .meta{font-size:0.9rem;color:#333}
    .muted{color:var(--muted);font-size:0.9rem}
    .center{display:flex;gap:10px;align-items:center}
    .avatar{width:96px;height:96px;border-radius:999px;object-fit:cover;border:2px solid #eee}
    .hidden{display:none}
    @media (max-width:880px){ .grid{grid-template-columns:1fr;} .row{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <h1>Your Account</h1>
      <div class="center">
        <div id="loginStatus" class="small muted">Loading...</div>
        <button id="btn_signout" class="ghost">Sign out</button>
      </div>
    </div>

    <div class="grid">
      <aside class="sidebar card">
        <a href="#" class="active" data-tab="profile">My Profile</a>
        <a href="#" data-tab="orders">My Orders</a>
        <a href="#" data-tab="addresses">Saved Addresses</a>
        <a href="#" data-tab="settings">Settings</a>
      </aside>

      <main>
        <section id="tab-profile" class="card">
          <div style="display:flex;gap:18px;align-items:center">
            <img id="avatar_preview" class="avatar" src="" alt="avatar" />
            <div style="flex:1">
              <div style="display:flex;gap:12px;align-items:center">
                <div>
                  <label>Profile picture (URL)</label>
                  <input id="avatar_url" type="text" placeholder="https://..." />
                </div>
              </div>
              <div class="small muted" style="margin-top:6px">Tip: paste a hosted image URL.</div>
            </div>
          </div>

          <hr style="margin:14px 0;border:none;border-top:1px solid #eee"/>

          <form id="profileForm">
            <div class="row">
              <div>
                <label>First name *</label>
                <input id="first_name" type="text" required />
              </div>
              <div>
                <label>Last name *</label>
                <input id="last_name" type="text" required />
              </div>
            </div>

            <div style="margin-top:12px">
              <label>Phone *</label>
              <input id="phone" type="tel" required />
            </div>

            <div style="margin-top:12px">
              <label>Alternate phone (optional)</label>
              <input id="alt_phone" type="tel" />
            </div>

            <div style="margin-top:12px">
              <label>Country</label>
              <input id="country" type="text" />
            </div>

            <div class="row" style="margin-top:12px">
              <div>
                <label>State</label>
                <input id="state" type="text" />
              </div>
              <div>
                <label>City</label>
                <input id="city" type="text" />
              </div>
            </div>

            <div class="row" style="margin-top:12px">
              <div>
                <label>Pin Code</label>
                <input id="postal_code" type="text" />
              </div>
              <div>
                <label>GST Number (optional)</label>
                <input id="gst" type="text" />
              </div>
            </div>

            <div style="margin-top:12px">
              <label>Notes / instructions</label>
              <textarea id="notes" rows="3"></textarea>
            </div>

            <div class="actions">
              <button id="btn_save" type="submit">Save profile</button>
              <button id="btn_cancel" type="button" class="ghost">Reset</button>
              <div id="profileStatus" class="small muted"></div>
            </div>
          </form>
        </section>

        <section id="tab-addresses" class="card hidden">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <h2 style="margin:0;font-size:18px">Saved Addresses</h2>
            <button id="btn_add_address">Add address</button>
          </div>

          <div id="addressesList" class="addresses" style="margin-top:12px"></div>

          <div id="addressFormWrap" class="hidden card" style="margin-top:12px">
            <h3 id="addressFormTitle">Add address</h3>
            <form id="addressForm">
              <div class="row">
                <div>
                  <label>Label</label>
                  <input id="addr_label" type="text" />
                </div>
                <div>
                  <label>Recipient phone</label>
                  <input id="addr_phone" type="tel" />
                </div>
              </div>

              <div style="margin-top:8px">
                <label>Address line</label>
                <input id="addr_line" type="text" />
              </div>

              <div class="row" style="margin-top:8px">
                <div>
                  <label>City</label>
                  <input id="addr_city" />
                </div>
                <div>
                  <label>State</label>
                  <input id="addr_state" />
                </div>
              </div>

              <div class="row" style="margin-top:8px">
                <div>
                  <label>Pin code</label>
                  <input id="addr_pincode" />
                </div>
                <div>
                  <label>Country</label>
                  <input id="addr_country" />
                </div>
              </div>

              <div style="margin-top:10px" class="actions">
                <button id="addr_save" type="submit">Save address</button>
                <button id="addr_cancel" type="button" class="ghost">Cancel</button>
                <div id="addrStatus" class="small muted"></div>
              </div>
            </form>
          </div>
        </section>

        <section id="tab-orders" class="card hidden">
          <h2>Orders</h2>
          <div class="muted">Orders will appear here.</div>
        </section>

        <section id="tab-settings" class="card hidden">
          <h2>Settings</h2>
          <div class="muted">Email: <span id="userEmail">-</span></div>
        </section>
      </main>
    </div>
  </div>

<script type="module">
import { supabase } from '/assets/js/supabase_client.js';
const $ = id => document.getElementById(id);

// Tabs
